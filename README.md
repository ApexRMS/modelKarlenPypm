# modelKarlenPypm

*modelKarlenPypm* add-on package (to epi) for estimating parameters and making regional projections of COVID-19 spread. 

It uses the discrete-time modelling framework [pypmca](https://pypm.github.io/home/) (Github [here](https://github.com/pypm/pypmca)) for interconnecting populations. *pypmca* is coded in Python, and various pre-tuned regional scenarios can be downloaded from the [pypmca Github](https://github.com/pypm/pypmca). In *modelKarlenPypm*, a desired pre-tuned scenario object (titled *<region_name>-<date/version>.pypm*) is downloaded; it contains all the modelling parameters, populations, delays, connectors, etc implemented by [Prof Dean Karlen (UVic)](https://www.uvic.ca/science/physics/vispa/people/faculty/karlen.php). Say it's scenario A.

A list of all the parameters of scenario A is generated by *getDefaultParameterValues.py* and exposed to the user for approval/changes (attributes that can be set include initial value, minimum and maximum values, prior distributions and parameters, status, etc.). These (potentially altered) parameter values and attributes are then readded (to A) by the file *getResults.py* to create a new scenario object B. *getResults.py* then gets case incidence from the given data file and fits scenario B to the supplied data. The values of the fitting parameters here will be incorporated to get a final scenario C. Multiple stochastic realisations of C are run, with the data (true incidence, expectations and all iterations) output to a data sheet for plotting. *MCMC.py* (to be added) will calculate the autocovariance and goodness of fit of the model, and MCMC methods are used to find posterior distributions of parameters chosen by the user.

In short:
scenario A downloaded -> initial values, fitting parameters, prior distributions etc. are changed -> scenario B is created with the new information -> real case data is fit and optimal parameter values are found -> newly fit parameters incorporated into some scenario C -> multiple iterations of C are run -> data output for plotting etc. -> autocovariance and simulation goodness of fit calculated and MCMC conducted -> posterior distributions saved and plotted.
